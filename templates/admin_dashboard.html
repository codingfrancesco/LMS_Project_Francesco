{% extends 'base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
    <div class="content-box">
        <h1>ğŸ”§ Admin Dashboard</h1>
        <p>Manage users, courses, lessons, and assignments.</p>
        
        <div style="margin: 30px 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
            <a href="{{ url_for('create_course') }}" style="padding: 15px; background: #04AA6D; color: white; text-decoration: none; border-radius: 8px; text-align: center; font-weight: 600;">â• Create Course</a>
        </div>
        
        <h2 style="margin-top: 40px;">ğŸ“Š System Statistics</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
            <div class="card" style="text-align: center;">
                <h3 style="margin: 0; color: #04AA6D;">{{ users|length }}</h3>
                <p style="margin: 10px 0 0 0; color: #666;">Total Users</p>
            </div>
            <div class="card" style="text-align: center;">
                <h3 style="margin: 0; color: #04AA6D;">{{ admins|length }}</h3>
                <p style="margin: 10px 0 0 0; color: #666;">Admin Users</p>
            </div>
        </div>
        
        <h2 style="margin-top: 40px;">ğŸ‘¥ All Users</h2>
        {% if users %}
        <div style="overflow-x: auto; margin-top: 20px;">
            <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden;">
                <thead>
                    <tr style="background: #f0f4f8; border-bottom: 2px solid #d4dce6;">
                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #2c3e50;">ID</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #2c3e50;">Username</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #2c3e50;">Email</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #2c3e50;">Full Name</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #2c3e50;">Status</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #2c3e50;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr style="border-bottom: 1px solid #ecf0f1;">
                        <td style="padding: 15px;">{{ user[0] }}</td>
                        <td style="padding: 15px;">{{ user[1] }}</td>
                        <td style="padding: 15px;">{{ user[2] }}</td>
                        <td style="padding: 15px;">{{ user[3] }}</td>
                        <td style="padding: 15px;">
                            {% if user[0] in admins|map(attribute=0) %}
                                <span style="background: #c8e6c9; color: #2e7d32; padding: 5px 10px; border-radius: 4px; font-weight: 600;">Admin</span>
                            {% else %}
                                <span style="background: #f0f4f8; color: #666; padding: 5px 10px; border-radius: 4px;">User</span>
                            {% endif %}
                        </td>
                        <td style="padding: 15px;">
                            {% if user[0] not in admins|map(attribute=0) %}
                                <form method="POST" action="{{ url_for('make_admin', user_id=user[0]) }}" style="display: inline;">
                                    <button type="submit" style="background: #04AA6D; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: 600;">Make Admin</button>
                                </form>
                            {% else %}
                                <button disabled style="background: #ccc; color: #666; border: none; padding: 8px 15px; border-radius: 5px; cursor: not-allowed; font-weight: 600;">Already Admin</button>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="card">
            <p style="color: #666;">No users found.</p>
        </div>
        {% endif %}
    </div>
{% endblock %}
